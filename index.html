<!DOCTYPE html>
<html lang="en">
<head>
    <title>Simple_Terminal</title>

    <!-- Recommended meta tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">

    <!-- PyScript CSS -->
    <link rel="stylesheet" href="https://pyscript.net/releases/2025.11.2/core.css">

    <!-- This script tag bootstraps PyScript -->
    <script type="module" src="https://pyscript.net/releases/2025.11.2/core.js"></script>

      <script>
        globalThis.init = Promise.withResolvers();
        globalThis.init.promise.then(utils => {
            const { xworker } = document.querySelector('[worker]');
            Object.assign(xworker.sync, utils);
        });
    </script>
    <style>
        #help_table, #help_table th, #help_table td {
            border: 1px solid black;
            border-collapse: collapse; /* Merges borders into a single line */
            padding: 8px; /* Adds space between content and borders */
            text-align: left; /* Aligns text to the left */
        }
        #help_table th {
          background-color: #dddddd; /* A light grey hex code */
        }
        /* Standard button style */
        .released {
            padding: 5px 20px;
            cursor: pointer;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            width: 100%;
        }
        
        /* Style when the button is 'staying down' */
        .pressed {
            background-color: #bbb;
            box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.2); /* Inset shadow for depth */
            transform: translateY(2px); /* Moves it down slightly */
        }   
          #terminal-wrapper {
            height: 200px;
            overflow-y: scroll; /* Forces vertical scrollbar to always show */
            border: 1px solid #ccc;
            overflow-anchor: auto;
          }
          #terminal-wrapper::-webkit-scrollbar {
            width: 8px;
          }
          #terminal-wrapper::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
          }
        </style>
</head>
<body>
  <body>
    <h3>Connections (DOM)</h3>
    <div id='all_things_channels'></div>
    <div id='all_things_hubs'></div>
    <script type="mpy-editor" src="./dom_code.py" config="./pyscript.toml" env = 'simple' setup></script>
    <h3>Coding Area (worker)</h3>
    Unit Tests: 
    <button id = "UT_channel">Channels</button>
    <button id = "UT_single">Single Motor</button>
    <button id = "UT_double">Double Motor</button>
    <button id = "UT_color">Color Sensor</button>
    <button id = "UT_controller">Controller</button>
    <script id="python-worker" env = 'simple' type = 'mpy-editor'>
import time
print('Waiting for permission...')
while channel.msg != 'go':
    time.sleep(0.1)
print('Waiting to Move...')
while motor.position <100:
    time.sleep(1)
channel.send('done')
print('Done')
    </script>
      <div id="terminal-wrapper">
    <script id="python-terminal" type="mpy" src="./worker_code.py" config="./pyscript.toml"env = 'simple' terminal worker></script>
</div>
    <button id = 'REPL_Run' hidden = true >Execute code in Terminal</button>
    <button id = 'REPL_RunE' hidden = true>Execute code in Terminal using CtrlE</button>
    <button id="myButton" class="released">Abort?</button>
    <br><br>
    <table id = 'help_table'>
        <thead>
            <tr><th>Command</th><th>Meaning</th><th>Usage</th></tr>
        </thead>
        <tr><td>channel.msg</td><td>returns the last value read</td><td>command.msg</td></tr>
        <tr><td>channel.send</td><td>sends a new value to the current channel</td><td>channel.send('test')</td></tr>
        <tr><td>channel.post</td><td>posts to any channel</td><td>channel.post('/fred','test')</td></tr>
        <tr><td>motor.run</td><td>Runs motor at speed 10</td><td>motor.run(10)</td></tr>
        <tr><td>motor.stop</td><td>Stops motor </td><td>motor.stop()</td></tr>
        <tr><td>motor.run_to</td><td>Turns to a specific position </td><td>motor.run_to(pos = 10, port = 1, direction = 2)</td></tr>
        <tr><td>motor.run_angle</td><td>Turns thru a specific angle </td><td>motor.run_angle(angle = 10, port = 1, direction = 2)</td></tr>
        <tr><td>motor.position</td><td>Returns the motor position</td><td>motor.position</td></tr>
        <tr><td>sensor.leftAngle</td><td>Returns the position of the left joystick</td><td>sensor.leftAngle</td></tr>
        <tr><td>sensor.reflection</td><td>Returns the value of reflected light</td><td>sensor.reflection</td></tr>
        <tr><td colspan="3"><em>There are a lot more methods and properties, just type sensor. and hit TAB in the REPL.  
            On motors, port is left(1) or right(2) and direction is CW (0), CCW (1), closest (2), or longest (3)</em></td></tr>
    </table>
    <h3>Advanced DOM coding area</h3>
    <script id="python-local"  env = 'simple' type = 'mpy-editor'>
from pyscript import document

CtrlC = document.getElementById('myButton')
    </script>

  </body>
</html>